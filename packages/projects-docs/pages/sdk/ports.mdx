---
title: Ports
description: Learn how you can interact with ports in your sandbox.
---

import { Callout } from 'nextra-theme-docs'

# Ports

The Ports API allows you to monitor and interact with HTTP ports in your sandbox. This is particularly useful when working with development servers or any other services that listen on specific ports.

Whenever a port is opened within a sandbox, we'll automatically expose it under `https://<sandbox-id>-<port>.csb.app`.

<Callout>
If the sandbox is private you need to use the [preview tokens](./preview-tokens).
</Callout>

Also, we'll automatically resume a sandbox whenever a port is accessed while the sandbox is hibernated.

## API

The Ports API is available under `sandbox.ports`. It provides methods for monitoring port activity and getting preview URLs for web services.

### Monitoring Ports

You can listen for ports being opened and closed in your sandbox:

```ts
const sandbox = await sdk.sandbox.create()
const session = await sandbox.connect()

// Listen for ports being opened
const listener1 = session.ports.onDidPortOpen((portInfo) => {
  console.log(`Port ${portInfo.port} opened`);
  console.log(`Preview URL: ${portInfo.url}`);
});

// Listen for ports being closed
const listener2 = session.ports.onDidPortClose((port) => {
  console.log(`Port ${port} closed`);
});

// Remove listeners when done
listener1.dispose();
listener2.dispose();
```

### Getting Port Information

You can get information about currently opened ports:

```ts
const sandbox = await sdk.sandbox.create()
const session = await sandbox.connect()

// Get all opened ports
const openPorts = session.ports.getOpenedPorts();
for (const port of openPorts) {
  console.log(`Port ${port.port} is open at ${port.url}`);
}
```

### Waiting for Ports

When starting services, you often need to wait for a port to become available:

```ts
const sandbox = await sdk.sandbox.create()
const session = await sandbox.connect()

// Start a development server
session.shells.run("npm run dev");

// Wait for the dev server port to open
const portInfo = await session.ports.waitForPort(3000);
console.log(`Dev server is ready at: ${portInfo.url}`);
```

## Examples

### Starting a Web Server

Here's a complete example of starting a web server and getting its preview URL:

```ts
const sandbox = await sdk.sandbox.create()
const session = await sandbox.connect()

// Start the server
session.shells.run("npx serve -y .");

// Wait for the server to be ready
const portInfo = await session.ports.waitForPort(3000);

// Apply protocol to the url
const url = 'https://' + portInfo.url
```

### Monitoring Multiple Ports

When working with multiple services, you might want to monitor several ports:

```ts
const sandbox = await sdk.sandbox.create()
const session = await sandbox.connect()

// Start monitoring before launching services
session.ports.onDidPortOpen((portInfo) => {
  switch (portInfo.port) {
    case 3000:
      console.log("Frontend server ready");
      break;
    case 3001:
      console.log("API server ready");
      break;
    case 5432:
      console.log("Database ready");
      break;
  }
});

// Start your services
session.shells.run("npm run start:all");
```
